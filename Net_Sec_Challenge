Jr. Penetration Tester: Net Sec Challenge 攻略手順 (IDS回避を含む)
このノートは、TryHackMeのNet Sec Challengeを通じて実行した具体的なステップと、そこで学んだツール、技術を記録します。

1. 偵察とポートスキャン
Nmapによる基本的な偵察
最初にターゲットの状況を把握するため、ポートスキャンを実行しました。
• 目的: 稼働しているホスト、開いているポート、稼働サービスを特定する。
• コマンド例: `nmap -sC -sV <ターゲットIP>`
• 学んだこと:
  • 開いているポート（特に21/FTP、22/SSH、80/HTTPなど）を特定。
　• 特にSERVICEがunknownの10021ポートを発見。-sVで調査したところftpサーバーであることを確認。
  • サービス名とバージョン情報（`-sV`）から、既知の脆弱性の有無を推測。
---
2. 認証情報の解析（Brute-Force Attack）
Hydraとrockyou.txtによるFTP認証解析
ユーザー名は問題よりわかっていたため、パスワードの解析を試みました。
• 目的: パスワードを総当たりで試行し、FTPサービスの認証情報を取得する
• ツール: Hydra (強力な並列処理ログインクラッカー)

• 辞書ファイル: `rockyou.txt` (世界で最も一般的に使用されるパスワードリスト)

• コマンド例: `hydra -L <ユーザー名> -P /usr/share/wordlists/rockyou.txt <ターゲットIP> ftp`で実行したところ、Password Not Found。
おそらく、ポートが21で指定されていたためアクセス拒否されていた。
コマンドを、`hydra -l <ユーザー名> -P /usr/share/wordlists/rockyou.txt ftp://<ターゲットIP>:10021`で実行したところ、パスワードを取得できた。
• 学んだこと:
  • 現実のパスワードは単純なものが多く、辞書攻撃の有効性を再認識した。
  • Hydraの並列処理能力と、ターゲットプロトコル（この場合は`ftp`）を指定する方法。
　• ftpは通常21ポートで接続されるため、nmapで発見した10021ポートのftpサーバーを指定してあげないとうまくいかないこと。
---
3. 初期アクセスと情報収集
FTPログインとファイルダウンロード
解析した認証情報を使用してFTPにログインし、さらなる侵入に必要なファイルを取得しました。
• コマンド例:
  1. `ftp <ターゲットIP> 10021`
  2. `user <解析したユーザー名>`
  3. `pass <解析したパスワード>`
  4. `ls` または `dir` でファイル一覧を確認
  5. `get <ファイル名>` でファイルをダウンロード
• 学んだこと:
  • FTPサーバー上に、設定ファイルやヒント、別のユーザーの**資格情報（認証情報）**など、次のステップへ繋がるファイルが置かれていることが多い。
  • FTPの基本操作（`get`、`put`、`ls`）を習得。
---
4. 侵入検知システム（IDS）回避技術
IDS回避のためのNmapオプション
IDSが検知する可能性を減らすために、スキャン方法を工夫しました。 [Image of IDS Bypass Techniques]
• 目的: IDSの署名ベースの検知ロジックや、レートリミットを回避する。
• 実行したテクニック:
  1. フラグメンテーション (`-f`): パケットを非常に小さな断片に分割して送信し、IDSによるパケットの再構築（Reassembly）を難しくする。
  2. ティミッドスキャン (`--badsum` / `--scan-delay`): パケット送信間隔を長く (`--scan-delay <時間>`) したり、非同期に (`--max-retries 0` と `--host-timeout` の組み合わせなど) スキャンすることで、レートリミットを回避する。
  3. デコイ (`-D`): スキャン元IPとして偽のIPアドレスを複数混ぜて送信し、攻撃者の特定を困難にする。
• 学んだこと:
  • セキュリティシステムは単なる検知だけでなく、パフォーマンスやプロトコル解析にも依存していること。
  • IDSを完全に回避するのは難しいが、検知の難易度を上げるための手法が存在すること。
